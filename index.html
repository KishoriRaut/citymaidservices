<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Maid Services - Find Reliable Domestic Help</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            primary: '#4F46E5',
                            secondary: '#4338CA',
                            light: '#EEF2FF',
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .profile-image {
                @apply aspect-[3/4] object-cover object-[center_15%];
            }
            
            .card-shadow {
                @apply shadow-md transition-all duration-300;
            }
            
            .card-shadow:hover {
                @apply shadow-lg -translate-y-0.5;
            }

            .section-title {
                @apply relative inline-block pb-4;
            }

            .section-title::after {
                content: '';
                @apply absolute bottom-0 left-1/2 -translate-x-1/2 w-20 h-[3px] bg-gradient-to-r from-brand-primary to-brand-secondary rounded-sm;
            }

            .badge {
                @apply bg-gradient-to-r from-brand-primary to-brand-secondary px-4 py-2 rounded-full text-white font-medium text-sm leading-5;
            }

            .truncate-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                @apply overflow-hidden;
            }
        }
    </style>
</head>
<body class="font-poppins">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center">
                    <a href="index.html" class="text-3xl font-bold text-brand-primary tracking-tight">City<span class="text-brand-secondary"> Maid Services</span></a>
                </div>
                <!-- Mobile menu button -->
                <div class="flex items-center md:hidden">
                    <button id="mobileMenuBtn" class="text-gray-700 hover:text-brand-primary focus:outline-none" aria-label="Open menu">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
                <!-- Desktop menu -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-brand-primary font-semibold">Home</a>
                    <a href="jobs/find-maids.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Maids</a>
                    <a href="jobs/find-jobs.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Jobs</a>
                    <a href="profile/create-profile.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Create Profile</a>
                    <a href="jobs/post-job.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Post a Job</a>
                    <a href="static/contact.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Contact Us</a>
                    <a href="static/about.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">About Us</a>
                    <a href="auth/signin.html" class="bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary font-semibold transition-colors">Sign In</a>
                </div>
            </div>
        </div>
        <!-- Mobile menu panel -->
        <div id="mobileMenu" class="hidden md:hidden fixed inset-0 bg-black bg-opacity-50 z-50">
            <div class="fixed inset-y-0 right-0 max-w-xs w-full bg-white shadow-xl">
                <div class="flex items-center justify-between p-4 border-b">
                    <div class="flex items-center space-x-4">
                        <button onclick="window.history.back()" class="text-gray-500 hover:text-gray-700" aria-label="Go back">
                            <i class="fas fa-arrow-left text-xl"></i>
                        </button>
                        <a href="index.html" class="text-gray-500 hover:text-gray-700" aria-label="Go to homepage">
                            <i class="fas fa-home text-xl"></i>
                        </a>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-900">Menu</h2>
                    <button id="closeMobileMenu" class="text-gray-500 hover:text-gray-700" aria-label="Close menu">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                <div class="p-4 space-y-4">
                    <a href="index.html" class="block text-brand-primary font-semibold py-2">Home</a>
                    <a href="jobs/find-maids.html" class="block text-gray-700 hover:text-brand-primary py-2">Find Maids</a>
                    <a href="jobs/find-jobs.html" class="block text-gray-700 hover:text-brand-primary py-2">Find Jobs</a>
                    <a href="profile/create-profile.html" class="block text-gray-700 hover:text-brand-primary py-2">Create Profile</a>
                    <a href="jobs/post-job.html" class="block text-gray-700 hover:text-brand-primary py-2">Post a Job</a>
                    <a href="static/contact.html" class="block text-gray-700 hover:text-brand-primary py-2">Contact Us</a>
                    <a href="static/about.html" class="block text-gray-700 hover:text-brand-primary py-2">About Us</a>
                    <a href="auth/signin.html" class="block bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary text-center font-semibold mt-4">Sign In</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="bg-brand-light py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
                    Find Trusted Domestic Help in Your Area
                </h1>
                <p class="text-lg text-gray-600 mb-8">
                    Connect with verified domestic helpers for all your household needs. Post jobs or find work opportunities easily.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="profile/create-profile.html" class="bg-brand-primary text-white px-8 py-4 rounded-lg hover:bg-brand-secondary transition-colors text-center font-semibold">
                        <i class="fas fa-user-plus mr-2"></i>Create Profile
                    </a>
                    <a href="jobs/post-job.html" class="bg-white text-brand-primary px-8 py-4 rounded-lg hover:bg-gray-50 transition-colors text-center font-semibold border-2 border-brand-primary">
                        <i class="fas fa-plus mr-2"></i>Post a Job
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Latest Available Maids Section -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Featured Domestic Helpers
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    Discover experienced and verified domestic helpers ready to assist you
                </p>
                <div class="mt-4 flex flex-wrap justify-center gap-4">
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="cookCount">-</span> Cooks
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="cleanerCount">-</span> Cleaners
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="childcareCount">-</span> Childcare
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="elderlyCount">-</span> Elderly Care
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="otherCount">-</span> Other Services
                    </div>
                </div>
            </div>
            <div id="latestMaidsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Loading placeholder -->
                <div class="col-span-full flex justify-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"></div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="jobs/find-maids.html" class="inline-block bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                    Browse All Profiles <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Latest Jobs Section -->
    <section class="py-16 bg-brand-light">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Recent Job Opportunities
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    Find your perfect domestic helper position with top employers
                </p>
                <div class="mt-4 flex flex-wrap justify-center gap-4">
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="cookJobsCount">-</span> Cook Jobs
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="cleanerJobsCount">-</span> Cleaner Jobs
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="childcareJobsCount">-</span> Childcare Jobs
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="elderlyJobsCount">-</span> Elderly Care Jobs
                    </div>
                    <div class="bg-brand-light px-4 py-2 rounded-lg">
                        <span class="text-brand-primary font-semibold" id="otherJobsCount">-</span> Other Jobs
                    </div>
                </div>
            </div>
            <div id="latestJobsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Loading placeholder -->
                <div class="col-span-full flex justify-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"></div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="jobs/find-jobs.html" class="inline-block bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                    View All Jobs <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Why Choose City Maid Services
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    We make finding domestic help simple, secure, and reliable
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-check text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Verified Profiles</h3>
                    <p class="text-gray-600">All domestic helpers are thoroughly verified for your safety</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-bolt text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Quick Matching</h3>
                    <p class="text-gray-600">Find the perfect match for your requirements quickly</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-shield-alt text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Secure Platform</h3>
                    <p class="text-gray-600">Your data and transactions are always protected</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
                <div>
                    <h3 class="text-2xl font-bold mb-6">City Maid Services</h3>
                    <p class="text-gray-400 leading-relaxed">Connecting trusted domestic help with employers in Nepal</p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-6">Quick Links</h3>
                    <ul class="space-y-4">
                        <li><a href="jobs/find-maids.html" class="text-gray-400 hover:text-white transition-colors">Find Maids</a></li>
                        <li><a href="jobs/find-jobs.html" class="text-gray-400 hover:text-white transition-colors">Find Jobs</a></li>
                        <li><a href="profile/create-profile.html" class="text-gray-400 hover:text-white transition-colors">Create Profile</a></li>
                        <li><a href="jobs/post-job.html" class="text-gray-400 hover:text-white transition-colors">Post a Job</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-6">Legal</h3>
                    <ul class="space-y-4">
                        <li><a href="static/privacy-policy.html" class="text-gray-400 hover:text-white transition-colors">Privacy Policy</a></li>
                        <li><a href="static/terms-of-service.html" class="text-gray-400 hover:text-white transition-colors">Terms of Service</a></li>
                        <li><a href="static/refund-policy.html" class="text-gray-400 hover:text-white transition-colors">Refund Policy</a></li>
                        <li><a href="static/cookie-policy.html" class="text-gray-400 hover:text-white transition-colors">Cookie Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-6">Contact Info</h3>
                    <p class="text-gray-400 mb-2">Address: Talchhikhel 15, Satdobato, Lalitpur, Nepal</p>
                    <p class="text-gray-400 mb-4">Email: info@citymaidservices.net</p>
                    <p class="text-gray-400">Phone: +977-9841317273</p>
                </div>
            </div>
        </div>
        <div class="border-t border-gray-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <p class="text-center text-gray-400">&copy; <span id="currentYear"></span> City Maid Services. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        // Initialize Supabase
        const supabaseUrl = 'https://fdgqqxyyofjnkhswkwcq.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZkZ3FxeHl5b2Zqbmtoc3drd2NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQwMjQyMTMsImV4cCI6MjA1OTYwMDIxM30.YyJLLu3r2a7Mh7ny0ie-YzzLfPh5PdrJJHnBFBxWqVE';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // Utility functions for loading and error states
        const showLoading = (element) => {
            element.innerHTML = `
                <div class="col-span-full flex justify-center items-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"></div>
                </div>
            `;
        };

        const showError = (element, message) => {
            element.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4">
                        <i class="fas fa-exclamation-circle text-2xl text-red-500"></i>
                    </div>
                    <p class="text-gray-500">${message}</p>
                    <button onclick="retryLoading()" class="mt-4 text-brand-primary hover:text-brand-secondary">
                        <i class="fas fa-redo mr-2"></i>Try Again
                    </button>
                </div>
            `;
        };

        const showNotification = (message, type = 'success') => {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            } text-white flex items-center`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
                ${message}
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.5s ease';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        };

        // Global variables for pagination
        let currentMaidPage = 0;
        let currentJobPage = 0;
        const itemsPerPage = 6;
        let hasMoreMaids = true;
        let hasMoreJobs = true;

        // Format salary
        function formatSalary(salary) {
            if (!salary) return 'Not specified';
            return new Intl.NumberFormat('en-NP', {
                style: 'currency',
                currency: 'NPR',
                maximumFractionDigits: 0
            }).format(salary);
        }

        // Retry loading function
        function retryLoading() {
            currentMaidPage = 0;
            currentJobPage = 0;
            loadLatestMaids();
            loadLatestJobs();
        }

        // Load more maids
        async function loadMoreMaids() {
            currentMaidPage++;
            await loadLatestMaids(true);
        }

        // Load more jobs
        async function loadMoreJobs() {
            currentJobPage++;
            await loadLatestJobs(true);
        }

        // Load maids with pagination
        async function loadLatestMaids() {
            const container = document.getElementById('latestMaidsContainer');
            const loadMoreBtn = document.getElementById('loadMoreMaids');
            
            showLoading(container);

            try {
                const { data: maids, error } = await supabase
                    .from('maids')
                    .select('*')
                    .eq('is_active', true)
                    .order('created_at', { ascending: false })
                    .limit(6); // Show only 6 profiles

                if (error) throw error;

                if (!maids || maids.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4">
                                <i class="fas fa-user-slash text-2xl text-gray-400"></i>
                            </div>
                            <p class="text-gray-500">No profiles available at the moment</p>
                        </div>
                    `;
                    return;
                }

                const maidsHTML = maids.map(maid => `
                    <div class="bg-white rounded-xl card-shadow overflow-hidden">
                        <div class="relative">
                            <img src="${maid.profile_image || 'https://placehold.co/300x400/eee/aaa?text=No+Image'}" 
                                 alt="${maid.full_name}" 
                                 class="w-full profile-image">
                            <div class="absolute top-4 right-4">
                                <span class="badge">
                                    ${maid.type}
                                </span>
                            </div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-semibold text-gray-900 mb-2">${maid.full_name}</h3>
                            <div class="space-y-2 mb-4">
                                <p class="text-gray-600 flex items-center">
                                    <i class="fas fa-map-marker-alt text-brand-primary mr-2 w-5"></i>
                                    ${maid.location}
                                </p>
                                <p class="text-gray-600 flex items-center">
                                    <i class="fas fa-clock text-brand-primary mr-2 w-5"></i>
                                    ${maid.working_hours || 'Not specified'}
                                </p>
                                <p class="text-gray-600 flex items-center">
                                    <i class="fas fa-star text-brand-primary mr-2 w-5"></i>
                                    ${maid.experience}
                                </p>
                                <p class="text-gray-600 flex items-center">
                                    <i class="fas fa-money-bill-wave text-brand-primary mr-2 w-5"></i>
                                    ${formatSalary(maid.expected_salary)}/month
                                </p>
                            </div>
                            <div class="flex flex-wrap gap-2 mb-4">
                                ${maid.services.slice(0, 3).map(service => `
                                    <span class="px-3 py-1 bg-brand-light text-brand-primary rounded-full text-sm">
                                        ${service}
                                    </span>
                                `).join('')}
                                ${maid.services.length > 3 ? `
                                    <span class="px-3 py-1 bg-brand-light text-brand-primary rounded-full text-sm">
                                        +${maid.services.length - 3} more
                                    </span>
                                ` : ''}
                            </div>
                            <button onclick="window.location.href='jobs/find-maids.html'" 
                                    class="w-full bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                                View Profile
                            </button>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = maidsHTML;

            } catch (error) {
                console.error('Error loading maids:', error);
                showError(container, 'Error loading profiles. Please try again later.');
                showNotification('Failed to load profiles', 'error');
            }
        }

        // Load jobs with pagination
        async function loadLatestJobs() {
            const container = document.getElementById('latestJobsContainer');
            const loadMoreBtn = document.getElementById('loadMoreJobs');
            
            showLoading(container);

            try {
                const { data: jobs, error } = await supabase
                    .from('jobs')
                    .select('*')
                    .eq('is_active', true)
                    .order('created_at', { ascending: false })
                    .limit(6); // Show only 6 jobs

                if (error) throw error;

                if (!jobs || jobs.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4">
                                <i class="fas fa-briefcase text-2xl text-gray-400"></i>
                            </div>
                            <p class="text-gray-500">No jobs available at the moment</p>
                        </div>
                    `;
                    return;
                }

                const jobsHTML = jobs.map(job => `
                    <div class="bg-white rounded-xl card-shadow p-6">
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-xl font-semibold text-gray-900 truncate-2">${job.owner_name}</h3>
                            <span class="badge ml-2 whitespace-nowrap">
                                ${job.type}
                            </span>
                        </div>
                        <div class="space-y-3 mb-4">
                            <p class="text-gray-600 flex items-center">
                                <i class="fas fa-map-marker-alt text-brand-primary mr-2 w-5"></i>
                                ${job.location}
                            </p>
                            <p class="text-gray-600 flex items-center">
                                <i class="fas fa-briefcase text-brand-primary mr-2 w-5"></i>
                                ${job.required_experience}
                            </p>
                            <p class="text-gray-600 flex items-center">
                                <i class="fas fa-clock text-brand-primary mr-2 w-5"></i>
                                ${job.working_hours}
                            </p>
                            <p class="text-gray-600 flex items-center">
                                <i class="fas fa-money-bill-wave text-brand-primary mr-2 w-5"></i>
                                ${formatSalary(job.salary)}/month
                            </p>
                        </div>
                        <div class="flex flex-wrap gap-2 mb-4">
                            ${job.services.slice(0, 3).map(service => `
                                <span class="px-3 py-1 bg-brand-light text-brand-primary rounded-full text-sm">
                                    ${service}
                                </span>
                            `).join('')}
                            ${job.services.length > 3 ? `
                                <span class="px-3 py-1 bg-brand-light text-brand-primary rounded-full text-sm">
                                    +${job.services.length - 3} more
                                </span>
                            ` : ''}
                        </div>
                        <p class="text-gray-600 mb-4 truncate-2">${job.description || 'No description available'}</p>
                        <button onclick="window.location.href='jobs/find-jobs.html'" 
                                class="w-full bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                            View Details
                        </button>
                    </div>
                `).join('');

                container.innerHTML = jobsHTML;

            } catch (error) {
                console.error('Error loading jobs:', error);
                showError(container, 'Error loading jobs. Please try again later.');
                showNotification('Failed to load jobs', 'error');
            }
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadLatestMaids();
            loadLatestJobs();
            updateCategoryCounts();
        });

        // Update category counts
        async function updateCategoryCounts() {
            try {
                // Get maids counts
                const { data: maidsCounts, error: maidsError } = await supabase
                    .from('maids')
                    .select('services')
                    .eq('is_active', true);

                if (maidsError) throw maidsError;

                // Get jobs counts
                const { data: jobsCounts, error: jobsError } = await supabase
                    .from('jobs')
                    .select('services')
                    .eq('is_active', true);

                if (jobsError) throw jobsError;

                // Count maids by service type
                const maidsByService = {
                    cook: 0,
                    cleaner: 0,
                    childcare: 0,
                    elderly: 0,
                    other: 0
                };

                // Count jobs by service type
                const jobsByService = {
                    cook: 0,
                    cleaner: 0,
                    childcare: 0,
                    elderly: 0,
                    other: 0
                };

                // Count maids by service
                maidsCounts.forEach(maid => {
                    if (maid.services) {
                        maid.services.forEach(service => {
                            const serviceLower = service.toLowerCase();
                            if (serviceLower.includes('cook')) maidsByService.cook++;
                            else if (serviceLower.includes('clean')) maidsByService.cleaner++;
                            else if (serviceLower.includes('child') || serviceLower.includes('baby')) maidsByService.childcare++;
                            else if (serviceLower.includes('elderly') || serviceLower.includes('old')) maidsByService.elderly++;
                            else maidsByService.other++;
                        });
                    }
                });

                // Count jobs by service
                jobsCounts.forEach(job => {
                    if (job.services) {
                        job.services.forEach(service => {
                            const serviceLower = service.toLowerCase();
                            if (serviceLower.includes('cook')) jobsByService.cook++;
                            else if (serviceLower.includes('clean')) jobsByService.cleaner++;
                            else if (serviceLower.includes('child') || serviceLower.includes('baby')) jobsByService.childcare++;
                            else if (serviceLower.includes('elderly') || serviceLower.includes('old')) jobsByService.elderly++;
                            else jobsByService.other++;
                        });
                    }
                });

                // Update maids counts
                document.getElementById('cookCount').textContent = maidsByService.cook;
                document.getElementById('cleanerCount').textContent = maidsByService.cleaner;
                document.getElementById('childcareCount').textContent = maidsByService.childcare;
                document.getElementById('elderlyCount').textContent = maidsByService.elderly;
                document.getElementById('otherCount').textContent = maidsByService.other;

                // Update jobs counts
                document.getElementById('cookJobsCount').textContent = jobsByService.cook;
                document.getElementById('cleanerJobsCount').textContent = jobsByService.cleaner;
                document.getElementById('childcareJobsCount').textContent = jobsByService.childcare;
                document.getElementById('elderlyJobsCount').textContent = jobsByService.elderly;
                document.getElementById('otherJobsCount').textContent = jobsByService.other;

            } catch (error) {
                console.error('Error updating category counts:', error);
            }
        }

        // Mobile menu functionality
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const closeMobileMenu = document.getElementById('closeMobileMenu');
            const mobileMenu = document.getElementById('mobileMenu');
            
            function toggleMobileMenu() {
                mobileMenu.classList.toggle('hidden');
                document.body.style.overflow = mobileMenu.classList.contains('hidden') ? '' : 'hidden';
            }
            
            mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            closeMobileMenu.addEventListener('click', toggleMobileMenu);
            
            // Close mobile menu when clicking outside
            mobileMenu.addEventListener('click', function(e) {
                if (e.target === mobileMenu) {
                    toggleMobileMenu();
                }
            });
            
            // Close mobile menu when clicking a link
            const mobileMenuLinks = mobileMenu.querySelectorAll('a');
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (!mobileMenu.classList.contains('hidden')) {
                        toggleMobileMenu();
                    }
                });
            });
            
            // Close mobile menu on window resize if screen becomes large
            window.addEventListener('resize', function() {
                if (window.innerWidth >= 768 && !mobileMenu.classList.contains('hidden')) {
                    toggleMobileMenu();
                }
            });
        });
    </script>
</body>
</html>